<!DOCTYPE html>
<html>
  <head>
    <title>Dice Simulator</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <style>
      body {
        background-color: #1a1a1a;
        color: white;
        font-family: 'Poppins', sans-serif;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
      }
      button {
        width: 150px;
        height: 80px;
        font-size: 1.2rem;
        border-radius: 10px;
        border: 2px solid white;
        background-color: #333;
        color: white;
        cursor: pointer;
        font-family: 'Poppins', sans-serif;
        margin: 0.5rem;
      }
      button:hover {
        background-color: #555;
      }
      a {
        display: block;
        text-align: center;
      }
      .chart {
        display: flex;
        flex-direction: column;
        align-items: center;
      }
      .stats {
        display: flex;
        width: 500px;
        justify-content: space-around;
        margin-top: 0.5rem;
        font-size: 0.9rem;
      }
      canvas {
        border: 2px solid #444;
      }
    </style>
  </head>
  <body>
    <div style="text-align: center;">
      <h1>Dice Simulator</h1>

      <img id="dice" src="RealDice1.png" alt="the dice" style="width:300px;height:300px;">

      <br>
      <button id="roll" onclick="rollDice()">ROLL</button>
      <button onclick="resetDice()">RESET</button>
      <br>

      <div class="chart">
        <canvas id="gameCanvas" width="500" height="500"></canvas>
        <div class="stats">
          <div id="Text1">1: 0/0 = 0%</div>
          <div id="Text2">2: 0/0 = 0%</div>
          <div id="Text3">3: 0/0 = 0%</div>
          <div id="Text4">4: 0/0 = 0%</div>
          <div id="Text5">5: 0/0 = 0%</div>
          <div id="Text6">6: 0/0 = 0%</div>
        </div>
      </div>

      <a href="index.html"><button>Home Page</button></a>
    </div>

    <script>
      var diceImg = document.getElementById("dice");
      var frequency = [0,0,0,0,0,0];
      var canvas = document.getElementById("gameCanvas");
      var ctx = canvas.getContext("2d");
      var total = 0;

      // Preload all dice images
      var diceImages = [];
      for (let i = 1; i <= 6; i++) {
        let img = new Image();
        img.src = "RealDice" + i + ".png";
        diceImages[i-1] = img;
      }

      function drawChart() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        for (let i = 0; i < 6; i++) {
          let count = frequency[i];
          if (count === 0) continue;

          let size, gap;
          if (count <= 6) {
            size = 64;
            gap = 16;
          } else {
            // canvas.height = size * count + (size/4) * (count - 1)
            // solve for size:
            size = canvas.height / (count + (count - 1) / 4);
            gap = size / 4;
          }

          let xPos = 18 + i * 80;

          for (let j = 0; j < count; j++) {
            // j=0 is most recent (top), j=count-1 is oldest (bottom)
            let yPos = canvas.height - size - j * (size + gap);
            ctx.drawImage(diceImages[i], xPos, yPos, size, size);
          }
        }
      }

      function updateStats() {
        for (let i = 0; i < 6; i++) {
          let pct = total === 0 ? 0 : Math.floor(100 * frequency[i] / total);
          document.getElementById("Text" + (i+1)).innerHTML =
            (i+1) + ": " + frequency[i] + "/" + total + " = " + pct + "%";
        }
      }

      function rollDice() {
        total += 1;
        let x = Math.floor((Math.random() * 6) + 1);
        frequency[x-1] += 1;
        diceImg.src = "RealDice" + x + ".png";
        drawChart();
        updateStats();
      }

      function resetDice() {
        frequency = [0,0,0,0,0,0];
        total = 0;
        diceImg.src = "RealDice1.png";
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        updateStats();
      }
    </script>
  </body>
</html>
