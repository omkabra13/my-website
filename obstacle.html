<!DOCTYPE html>
<html>
<head>
    <title>Simple Canvas Game</title>
    <style>
        body { background-color: #222; color: white; text-align: center; font-family: sans-serif; }
        /* Centering the game board */
        canvas { background-color: black; border: 2px solid white; display: block; margin: 0 auto; }
    </style>
</head>
<body>
    <h1>Obstacle Game</h1> 
    <h1>Use Arrow Keys To Move</h1> 
    <h1>Collide with the blue blocks</h1>
    <h1>Don't collide with the red blocks</h1> 
    <h1>HP: <span id="hp">10</span> | Score: <span id="score">0</span></h1>
    <div id="gameOverScreen" style="display: none; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: rgba(0,0,0,0.8); padding: 20px; border: 2px solid red; color: white; z-index: 10;">
        <h1>GAME OVER</h1>
        <p>Final Score: <span id="finalScore">0</span></p>
        <button onclick="location.reload()" style="padding: 10px 20px; cursor: pointer; background: red; color: white; border: none; font-weight: bold;">TRY AGAIN</button>
        <br>
        <br>
        <a href="index.html">
          <button style = "width: 250px; height: 100px; font-size: 40px; background-color: Yellow; color: Red; border-radius: 20px;">Home Page</button>
        </a>
    </div>
    <canvas id="gameCanvas" width="800" height="600"></canvas>
    
    <script>
        
        var canvas = document.getElementById("gameCanvas");
        var ctx = canvas.getContext("2d");

        // Game State
        var hp = 20;
        var score = 0;
        var enemies = [];
        var friends = []; 

        var playerX = 380;
        var playerY = 540;
        var playerSize = 40;
        var speed = 40;

        var done = 0;

        // SPAWN ENEMIES (Red) - Every 1 second
        setInterval(function() {
            enemies.push({
                x: Math.random() * (canvas.width - 20),
                y: -20,
                size: 20,
                speed: 2+score*0.3
            });
        }, 1800-score*100);

        // SPAWN FRIENDS (Blue) - Every 2 seconds
        setInterval(function() {
            friends.push({
                x: Math.random() * (canvas.width - 20),
                y: -20,
                size: 20,
                speed: 1.5+score*0.2
            });
        }, 2300-score*150);

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // 1. Draw Player (Green)
            ctx.fillStyle = "lime";
            ctx.fillRect(playerX, playerY, playerSize, playerSize);

            // 2. Handle Enemies (Red)
            ctx.fillStyle = "red";
            for (var i = 0; i < enemies.length; i++) {
                var e = enemies[i];
                e.y += e.speed; 
                ctx.fillRect(e.x, e.y, e.size, e.size);

                // Collision with Red: Lose 1 HP
                if (playerX < e.x + e.size && playerX + playerSize > e.x && playerY < e.y + e.size && playerY + playerSize > e.y) {
                    hp -= 1;
                    enemies.splice(i, 1);
                    i--;
                } 
                // Remove if off screen
                else if (e.y > canvas.height) {
                    enemies.splice(i, 1);
                    i--;
                }
            }

            // 3. Handle Friends (Blue)
            ctx.fillStyle = "deepskyblue";
            for (var j = 0; j < friends.length; j++) {
                var f = friends[j];
                f.y += f.speed; 
                ctx.fillRect(f.x, f.y, f.size, f.size);

                // Collision with Blue: +1 Score
                if (playerX < f.x + f.size && playerX + playerSize > f.x && playerY < f.y + f.size && playerY + playerSize > f.y) {
                    score += 1;
                    friends.splice(j, 1);
                    j--;
                } 
                // MISS the Blue: Lose 1 HP
                else if (f.y > canvas.height) {
                    hp -= 1; 
                    friends.splice(j, 1);
                    j--;
                }
            }

            // Update UI
            document.getElementById("hp").innerText = hp;
            document.getElementById("score").innerText = score;

            // Check Death
            if (hp <= 0 & done === 0) {
                document.getElementById("gameOverScreen").style.display = "block";
    
                // 2. Put the final score inside it
                document.getElementById("finalScore").innerText = score;
    
                // 3. Stop the game from continuing in the background
                return;
            }

            requestAnimationFrame(draw);
        }

        // Controls
        window.addEventListener("keydown", function(event) {
            if (event.key === "ArrowRight" && playerX <= canvas.width - playerSize) {
                playerX += speed;
            }
            if (event.key === "ArrowLeft" && playerX >= 0) {
                playerX -= speed;
            }
            
        });

        draw();
    </script>
</body>
</html>
